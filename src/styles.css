:root {
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  --pc-bg: radial-gradient(1200px circle at 20% 0%, #111827 0%, #0b0f14 55%, #070a0e 100%);
  --pc-card: rgba(14, 18, 26, 0.92);
  --pc-panel: rgba(8, 11, 16, 0.62);
  --pc-border: rgba(148, 163, 184, 0.14);
  --pc-text: #e8eef8;
  --pc-muted: rgba(226, 232, 240, 0.62);
  --pc-accent: #60a5fa;
  --pc-accent-2: #22d3ee;
  --pc-danger: #fb7185;
  --pc-radius-card: 14px;
  --pc-radius-control: 8px;
  --pc-font-base: 14px;
  --pc-font-sm: 12.5px;
  --pc-font-md: 13px;
  --pc-font-lg: 20px;
  --pc-control-py: 4px;
  --pc-control-px: 8px;
  --pc-control-gap: 6px;
  color-scheme: dark;
}

* { box-sizing: border-box; }
body {
  margin: 0;
  min-height: 100vh;
  font-size: var(--pc-font-base);
  background: var(--pc-bg);
  color: var(--pc-text);
}

.app-shell {
  min-height: 100vh;
  display: grid;
  place-items: center;
  padding: 1.25rem;
}

.card {
  width: min(1280px, 100%);
  border: 1px solid var(--pc-border);
  border-radius: calc(var(--pc-radius-card) + 2px);
  padding: 1rem;
  background: var(--pc-card);
  box-shadow: 0 18px 48px rgba(0, 0, 0, 0.35);
  backdrop-filter: blur(10px);
  display: grid;
  gap: 0.85rem;
}

.header-row { display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem; }
.header-controls { display: flex; flex-wrap: wrap; gap: 0.5rem; }
h1 { margin: 0 0 0.25rem; font-size: var(--pc-font-lg); letter-spacing: 0.01em; }
h2 { margin: 0 0 0.35rem; font-size: 16px; font-weight: 650; }
.status-line { margin: 0; font-size: var(--pc-font-sm); color: var(--pc-muted); }

label { display: grid; gap: 0.28rem; font-size: var(--pc-font-sm); color: var(--pc-muted); }
button,
input,
select,
fieldset {
  border-radius: var(--pc-radius-control);
}
button,
input,
select {
  font-size: var(--pc-font-md);
  line-height: 1.1;
  min-height: 28px;
  border: 1px solid color-mix(in oklab, var(--pc-border) 85%, rgba(255, 255, 255, 0.3));
  background: color-mix(in oklab, var(--pc-panel) 88%, transparent);
  color: var(--pc-text);
  padding: var(--pc-control-py) var(--pc-control-px);
  transition: border-color 120ms ease, background-color 120ms ease, box-shadow 120ms ease;
}
button { cursor: pointer; }
button:hover:not(:disabled) {
  border-color: color-mix(in oklab, var(--pc-accent) 62%, white);
  background: color-mix(in oklab, var(--pc-panel) 75%, rgba(255, 255, 255, 0.06));
}
button:disabled,
input:disabled,
select:disabled { opacity: 0.65; cursor: not-allowed; }

.actions-grid { display: grid; gap: 0.45rem; grid-template-columns: minmax(0, 1fr); }
.actions-grid > button {
  font-weight: 700;
  border-color: color-mix(in oklab, var(--pc-accent) 65%, var(--pc-accent-2));
  background: linear-gradient(135deg, color-mix(in oklab, var(--pc-accent) 68%, #ffffff 4%), color-mix(in oklab, var(--pc-accent-2) 82%, #0f172a 8%));
  color: #ecfeff;
}
.actions-grid > button:hover:not(:disabled) {
  border-color: color-mix(in oklab, var(--pc-accent-2) 70%, #ffffff 24%);
  box-shadow: 0 0 0 1px rgba(96, 165, 250, 0.28), 0 8px 20px rgba(34, 211, 238, 0.16);
}

.panel-card {
  display: grid;
  gap: 0.75rem;
  border: 1px solid var(--pc-border);
  border-radius: var(--pc-radius-card);
  padding: 0.8rem;
  background: color-mix(in oklab, var(--pc-panel) 86%, transparent);
}

.studio-layout {
  display: grid;
  grid-template-columns: minmax(260px, 360px) minmax(0, 1fr) minmax(280px, 360px);
  gap: 0.85rem;
}
.studio-center { min-width: 0; }
.studio-bottom { grid-column: 1 / -1; position: sticky; bottom: 0.25rem; z-index: 2; }

.previewModeFieldset label { display: flex; align-items: center; gap: 0.45rem; }
.previewModeFieldset input[type='radio'],
.previewModeFieldset input[type='checkbox'] { margin: 0; min-height: 14px; }
fieldset {
  border: 1px solid var(--pc-border);
  padding: 0.65rem;
  display: grid;
  gap: 0.45rem;
  background: color-mix(in oklab, var(--pc-panel) 75%, transparent);
}
legend { font-size: var(--pc-font-sm); color: var(--pc-muted); padding: 0 0.25rem; }

:focus-visible {
  outline: 2px solid color-mix(in oklab, var(--pc-accent) 75%, white);
  outline-offset: 2px;
}

.checkboxInline { display: inline-flex; align-items: center; gap: 0.45rem; }
.dyeControlsRow { display: flex; flex-wrap: wrap; align-items: center; gap: var(--pc-control-gap); }
.dyeNumberLabel { margin-right: 0.15rem; }
.dyeGrid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(22px, 1fr));
  gap: 0.35rem;
  max-height: 180px;
  overflow: auto;
}
.swatch {
  width: 100%;
  aspect-ratio: 1 / 1;
  min-width: 22px;
  padding: 0;
  border: 1px solid rgba(255, 255, 255, 0.18);
  border-radius: 7px;
}
.swatch:hover { border-color: rgba(255, 255, 255, 0.45); }
.swatchSelected {
  border-color: color-mix(in oklab, var(--pc-accent) 75%, white);
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--pc-accent) 50%, transparent);
}
.srOnly { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }

.canvas-selector { display: grid; gap: 0.55rem; }
.canvas-selector__resolved { margin: 0; font-size: var(--pc-font-sm); color: var(--pc-muted); }
.image-input { display: grid; gap: 0.5rem; }
.image-input__dropzone {
  border: 1px dashed color-mix(in oklab, var(--pc-border) 70%, white 8%);
  border-radius: 12px;
  padding: 0.9rem;
  text-align: center;
  color: var(--pc-text);
  background: color-mix(in oklab, var(--pc-panel) 88%, transparent);
  transition: border-color 120ms ease, background-color 120ms ease;
}
.image-input__dropzone p { margin: 0; font-size: var(--pc-font-sm); }
.preview-pane img { user-select: none; -webkit-user-drag: none; }
.previewHero {
  gap: 0.65rem;
  min-height: 100%;
}
.previewHero__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
}
.previewHero__header h2 { margin: 0; }
.previewHero__badge {
  font-size: var(--pc-font-sm);
  padding: 0.2rem 0.5rem;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--pc-accent) 40%, var(--pc-border));
  background: color-mix(in oklab, var(--pc-accent) 16%, var(--pc-panel));
  color: color-mix(in oklab, white 90%, var(--pc-accent));
}
.previewHero__bannerWrap { display: grid; gap: 0.35rem; }
.previewHero__banner {
  margin: 0;
  padding: 0.35rem 0.55rem;
  border-radius: 0.5rem;
  font-size: var(--pc-font-sm);
}
.previewHero__banner--warning {
  border: 1px solid #7c4a03;
  background: rgba(245, 158, 11, 0.12);
  color: #fcd34d;
}
.previewHero__banner--error {
  border: 1px solid color-mix(in oklab, var(--pc-danger) 55%, black);
  background: color-mix(in oklab, var(--pc-danger) 20%, transparent);
  color: #fecdd3;
}
.previewHero__body {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: clamp(260px, 42vh, 560px);
}
.previewHero__frame {
  position: relative;
  width: 100%;
  min-height: clamp(240px, 38vh, 520px);
  border: 1px solid var(--pc-border);
  border-radius: 14px;
  padding: 14px;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  background:
    radial-gradient(circle at 20% 0%, rgba(96, 165, 250, 0.07), transparent 45%),
    linear-gradient(135deg, rgba(15, 23, 42, 0.35), rgba(2, 6, 23, 0.1)),
    repeating-linear-gradient(0deg, rgba(148, 163, 184, 0.06) 0 1px, transparent 1px 20px),
    repeating-linear-gradient(90deg, rgba(148, 163, 184, 0.05) 0 1px, transparent 1px 20px);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.03), 0 14px 24px rgba(2, 6, 23, 0.24);
}
.previewHero__body--ready .previewHero__frame {
  box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--pc-accent) 15%, transparent), 0 14px 24px rgba(2, 6, 23, 0.24);
}
.preview-pane__image {
  display: block;
  max-width: 100%;
  max-height: min(70vh, calc(100vh - 280px));
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 10px;
}
.previewHero__placeholder {
  margin: 0;
  color: var(--pc-muted);
  font-size: var(--pc-font-sm);
  text-align: center;
}
.image-input__dropzone:hover,
.image-input__dropzone--dragging {
  border-color: color-mix(in oklab, var(--pc-accent) 65%, white);
  background: color-mix(in oklab, var(--pc-accent) 18%, var(--pc-panel));
}
.image-input__error { margin: 0; color: var(--pc-danger); font-size: var(--pc-font-sm); }

.fileInput {
  position: absolute;
  left: -9999px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}
.fileButton {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  width: fit-content;
  min-height: 28px;
  padding: var(--pc-control-py) var(--pc-control-px);
  border: 1px solid color-mix(in oklab, var(--pc-border) 82%, rgba(255, 255, 255, 0.24));
  border-radius: var(--pc-radius-control);
  background: color-mix(in oklab, var(--pc-panel) 90%, transparent);
  color: var(--pc-text);
  cursor: pointer;
  font-size: var(--pc-font-md);
  line-height: 1.1;
}
.fileButton:hover {
  border-color: color-mix(in oklab, var(--pc-accent) 62%, white);
  background: color-mix(in oklab, var(--pc-panel) 70%, rgba(255, 255, 255, 0.06));
}

input[type='range'] {
  height: 18px;
  padding: 0;
  background: transparent;
  accent-color: var(--pc-accent);
}
input[type='range']::-webkit-slider-runnable-track {
  height: 4px;
  border-radius: 999px;
  background: color-mix(in oklab, var(--pc-panel) 62%, rgba(148, 163, 184, 0.38));
}
input[type='range']::-webkit-slider-thumb {
  -webkit-appearance: none;
  margin-top: -4px;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: 1px solid rgba(255, 255, 255, 0.45);
  background: linear-gradient(180deg, var(--pc-accent), var(--pc-accent-2));
}
input[type='range']::-moz-range-track {
  height: 4px;
  border-radius: 999px;
  background: color-mix(in oklab, var(--pc-panel) 62%, rgba(148, 163, 184, 0.38));
}
input[type='range']::-moz-range-thumb {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: 1px solid rgba(255, 255, 255, 0.45);
  background: linear-gradient(180deg, var(--pc-accent), var(--pc-accent-2));
}

.previewWrap { position: relative; }
.previewOverlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0, 0, 0, 0.2); backdrop-filter: blur(1px); }
.previewOverlay__content { display: grid; justify-items: center; gap: 0.35rem; color: #e2e8f0; font-size: var(--pc-font-sm); }
.spinner { width: 18px; height: 18px; border-radius: 999px; border: 2px solid rgba(255, 255, 255, 0.25); border-top-color: rgba(255, 255, 255, 0.9); animation: spin 0.8s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

.advanced-toggle { width: 100%; text-align: left; font-weight: 600; }
.advanced-panel { display: grid; gap: 0.55rem; padding: 0.6rem; border: 1px solid var(--pc-border); border-radius: var(--pc-radius-control); background: var(--pc-panel); }
.advanced-panel__fieldset { margin: 0; background: color-mix(in oklab, var(--pc-panel) 90%, black); }
.advanced-panel__fieldset details { display: grid; gap: 0.45rem; }
.advanced-panel__diag-toggle { width: fit-content; }
.advanced-panel__diagnostics { margin-top: 0.45rem; }

.intro-splash { position: fixed; inset: 0; background: rgba(2, 6, 23, 0.72); z-index: 12; display: grid; place-items: center; padding: 1rem; }
.intro-splash__card { width: min(620px, 100%); border: 1px solid var(--pc-border); border-radius: var(--pc-radius-card); background: var(--pc-card); padding: 1rem 1.1rem; display: grid; gap: 0.75rem; }
.intro-splash__card ul { margin: 0; padding-left: 1.25rem; display: grid; gap: 0.3rem; }
.intro-splash__actions { display: flex; align-items: center; justify-content: flex-end; gap: 0.75rem; }

.dyeGrid,
.advanced-panel__diagnostics {
  scrollbar-width: thin;
  scrollbar-color: color-mix(in oklab, var(--pc-accent) 45%, transparent) transparent;
}

@media (max-width: 960px) {
  .studio-layout { grid-template-columns: 1fr; }
  .studio-bottom { position: static; }
  .header-row { flex-direction: column; }
}
